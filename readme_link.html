

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>MantisShrimp &mdash; mantisshrimp  documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Contributing to MantisShrimp" href="contributing.html" />
    <link rel="prev" title="Mantisshrimp Documentation" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> mantisshrimp
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">MantisShrimp</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#the-problem-we-are-solving">The Problem We Are Solving</a></li>
<li class="toctree-l2"><a class="reference internal" href="#our-solution">Our Solution</a></li>
<li class="toctree-l2"><a class="reference internal" href="#why-mantishrimp">Why Mantishrimp</a></li>
<li class="toctree-l2"><a class="reference internal" href="#hall-of-fame">Hall of Fame</a></li>
<li class="toctree-l2"><a class="reference internal" href="#quick-start-use-mantisshrimp-docker-container">Quick Start: Use Mantisshrimp Docker Container</a></li>
<li class="toctree-l2"><a class="reference internal" href="#manual-install">Manual Install</a></li>
<li class="toctree-l2"><a class="reference internal" href="#quick-example-how-to-train-the-wheat-dataset">Quick Example: How to train the <strong>Wheat Dataset</strong></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#tutorials">Tutorials</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#contributing">Contributing</a></li>
<li class="toctree-l2"><a class="reference internal" href="#faqs-and-feature-requests">FAQs and Feature Requests</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing to MantisShrimp</a></li>
<li class="toctree-l1"><a class="reference internal" href="faqs.html">FAQs</a></li>
</ul>
<p class="caption"><span class="caption-text">Mantisshrimp Models:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tutorials/mantisshrimp_models/faster_rcnn_adv.html">Faster RCNN Advanced Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/mantisshrimp_models/faster_rcnn_quickstart.html">1. FasterRCNN Quickstart</a></li>
</ul>
<p class="caption"><span class="caption-text">Mantisshrimp Data:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tutorials/mantisshrimp_data/intro_parser.html">1. Intro to Mantisshrimp Parsers</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/mantisshrimp_data/parsers_voc.html">2. VOC Parser with FasterRCNN</a></li>
</ul>
<p class="caption"><span class="caption-text">Mantisshrimp Hub:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tutorials/mantisshrimp_hub/hub_detr_finetune_pennfundan.html">1. Fine-tune DETR on PenFundan</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/mantisshrimp_hub/hub_wheat_finetun.html">2. Fine-tune Detr on Wheat</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">mantisshrimp</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>MantisShrimp</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/readme_link.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="mantisshrimp">
<h1>MantisShrimp<a class="headerlink" href="#mantisshrimp" title="Permalink to this headline">¶</a></h1>
<blockquote>
<div><p>MantisShrimp is in very early development, all contributions are
welcome! Be sure to check the <code class="docutils literal notranslate"><span class="pre">issues</span></code> board =)</p>
</div></blockquote>
<p><a class="reference external" href="https://github.com/lgvaz/mantisshrimp/actions?query=workflow%3Atests"><img alt="tests" src="https://github.com/lgvaz/mantisshrimp/workflows/tests/badge.svg?event=push" /></a> <a class="reference external" href="https://lgvaz.github.io/mantisshrimp/index.html"><img alt="docs" src="https://github.com/lgvaz/mantisshrimp/workflows/docs/badge.svg" /></a> <a class="reference external" href="https://codecov.io/gh/lgvaz/mantisshrimp"><img alt="codecov" src="https://codecov.io/gh/lgvaz/mantisshrimp/branch/master/graph/badge.svg" /></a> <a class="reference external" href="https://github.com/psf/black"><img alt="black" src="https://img.shields.io/badge/code%20style-black-000000.svg" /></a> <a class="reference external" href="https://github.com/lgvaz/mantisshrimp/blob/master/LICENSE"><img alt="license" src="https://img.shields.io/badge/License-Apache%202.0-blue.svg" /></a></p>
<hr class="docutils" />
<img alt="images/mantisshrimp-logo.png" src="images/mantisshrimp-logo.png" />
<div class="section" id="the-problem-we-are-solving">
<h2>The Problem We Are Solving<a class="headerlink" href="#the-problem-we-are-solving" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Object dectection datasets come in different sizes and most impotantly have different annotations formats ranging from the stanndard formarts such COCO and VOC to more self-tailored formats</p></li>
<li><p>When new object detection models are released with some source code, the latter is very often written in non-portable way: The source code is difficult to use for other datasets because of some hard-coded parts coupled with self developed tweaks</p></li>
<li><p>Both researchers and DL coders have to deploy a lot of effort to use many SOTA models for their own use-cases and/or to craft an enhanced model based on those already published</p></li>
</ul>
</div>
<div class="section" id="our-solution">
<h2>Our Solution<a class="headerlink" href="#our-solution" title="Permalink to this headline">¶</a></h2>
<p>Mantisshrimp library provides some elegant solutions in those 2 fundamental components:</p>
<p><strong>1- A Unified Data API:</strong></p>
<p>Out of the box, we offer several annotation parsers that translates different annotation formats into a very flexibe parser:</p>
<ol class="upperalpha simple">
<li><p>By default, we offer  differents standard format parsers such as COCO and ROC,</p></li>
<li><p>We host a community curated parsers where community contributors publish their own parsers to be shared, and therefore save time and energy in creating similar parsers over and over (check out the Kaggle <a class="reference external" href="https://lgvaz.github.io/mantisshrimp/tutorials/mantisshrimp_models/faster_rcnn_quickstart.html">Quickstart</a> parser),</p></li>
<li><p>We provide some intuitive tutorials that walk you through the steps of creating your own parser. Please, consider sharing it with the whole community.</p></li>
</ol>
<p><strong>2- A Universal Adapter to different DL Libraries:</strong></p>
<ol class="upperalpha simple">
<li><p>Mantisshrimp provides a universal adapter that allows you to hook up your dataset to the DL library of your choice (fastai, Pytorch Lightning and Pytorch), and train your model using a familiar API,</p></li>
<li><p>Our library allows you to choose one of the public implementations of a given model, plug it in mantisshrimp model adapter, and seamlessly train your model,</p></li>
<li><p>As a bonus, our library even allows to experiment with another DL library. Our tutorials have several examples showing you how to train a given model using both fastai and Pytorch Lightning libraries side by side.</p></li>
</ol>
</div>
<div class="section" id="why-mantishrimp">
<h2>Why Mantishrimp<a class="headerlink" href="#why-mantishrimp" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Mantisshrimp: An object-detection library</p></li>
<li><p>Connects to different libraries/framework such as fastai, Pytorch Lightning, and Pytorch</p></li>
<li><p>Features a Unified Data API such: common Parsers (COCO, etc.),</p></li>
<li><p>Integrates community maintaned parsers for custom datasets shared on parsers hub</p></li>
<li><p>Provides flexible model implementations using different backbones</p></li>
<li><p>Helps both researchers and DL engineers in reproducing, replicating published models</p></li>
<li><p>Facilitates applying both existing and new models to standard datasets as well as custom datasets</p></li>
</ul>
<p><strong>Note:</strong>  If you find this work useful, please let other people know by <strong>starring</strong> it. Thank you!</p>
</div>
<div class="section" id="hall-of-fame">
<h2>Hall of Fame<a class="headerlink" href="#hall-of-fame" title="Permalink to this headline">¶</a></h2>
<p>This library is only made possible because of &#64;all-contributors, thank you ♥️ ♥️ ♥️</p>
<p><a class="reference external" href="https://sourcerer.io/fame/lgvaz/lgvaz/mantisshrimp/links/0"><img alt="image0" src="https://sourcerer.io/fame/lgvaz/lgvaz/mantisshrimp/images/0" /></a><a class="reference external" href="https://sourcerer.io/fame/lgvaz/lgvaz/mantisshrimp/links/1"><img alt="image1" src="https://sourcerer.io/fame/lgvaz/lgvaz/mantisshrimp/images/1" /></a><a class="reference external" href="https://sourcerer.io/fame/lgvaz/lgvaz/mantisshrimp/links/2"><img alt="image2" src="https://sourcerer.io/fame/lgvaz/lgvaz/mantisshrimp/images/2" /></a><a class="reference external" href="https://sourcerer.io/fame/lgvaz/lgvaz/mantisshrimp/links/3"><img alt="image3" src="https://sourcerer.io/fame/lgvaz/lgvaz/mantisshrimp/images/3" /></a><a class="reference external" href="https://sourcerer.io/fame/lgvaz/lgvaz/mantisshrimp/links/4"><img alt="image4" src="https://sourcerer.io/fame/lgvaz/lgvaz/mantisshrimp/images/4" /></a><a class="reference external" href="https://sourcerer.io/fame/lgvaz/lgvaz/mantisshrimp/links/5"><img alt="image5" src="https://sourcerer.io/fame/lgvaz/lgvaz/mantisshrimp/images/5" /></a><a class="reference external" href="https://sourcerer.io/fame/lgvaz/lgvaz/mantisshrimp/links/6"><img alt="image6" src="https://sourcerer.io/fame/lgvaz/lgvaz/mantisshrimp/images/6" /></a><a class="reference external" href="https://sourcerer.io/fame/lgvaz/lgvaz/mantisshrimp/links/7"><img alt="image7" src="https://sourcerer.io/fame/lgvaz/lgvaz/mantisshrimp/images/7" /></a></p>
</div>
<div class="section" id="quick-start-use-mantisshrimp-docker-container">
<h2>Quick Start: Use Mantisshrimp Docker Container<a class="headerlink" href="#quick-start-use-mantisshrimp-docker-container" title="Permalink to this headline">¶</a></h2>
<p>To jumpstart using mantisshrimp package without manually installing it and its dependencies, use our docker container!</p>
<p>Please, follow the 3 steps:</p>
<ol class="arabic simple">
<li><p>Install Docker by following the instructions shown here: <a class="reference external" href="https://docs.docker.com/engine/install/">https://docs.docker.com/engine/install/</a> (Only if Docker is not already installed)</p></li>
<li><p>Run <cite>docker pull mantisshrimp</cite>, in your terminal</p></li>
<li><p>Run <cite>docker run -it mantisshrimp</cite>, in your terminal</p></li>
</ol>
<p>Enjoy!</p>
</div>
<div class="section" id="manual-install">
<h2>Manual Install<a class="headerlink" href="#manual-install" title="Permalink to this headline">¶</a></h2>
<p>Install pytorch via your preferred way.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip install git+git://github.com/lgvaz/mantisshrimp.git
pip install -U <span class="s1">&#39;git+https://github.com/cocodataset/cocoapi.git#subdirectory=PythonAPI&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="quick-example-how-to-train-the-wheat-dataset">
<h2>Quick Example: How to train the <strong>Wheat Dataset</strong><a class="headerlink" href="#quick-example-how-to-train-the-wheat-dataset" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mantisshrimp.imports</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">mantisshrimp</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">albumentations</span> <span class="k">as</span> <span class="nn">A</span>

<span class="n">source</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;/home/lgvaz/.data/wheat&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">source</span> <span class="o">/</span> <span class="s2">&quot;train.csv&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>

<span class="c1"># Custom parser</span>
<span class="n">data_splitter</span> <span class="o">=</span> <span class="n">RandomSplitter</span><span class="p">([</span><span class="o">.</span><span class="mi">8</span><span class="p">,</span> <span class="o">.</span><span class="mi">2</span><span class="p">])</span>
<span class="n">parser</span> <span class="o">=</span> <span class="n">WheatParser</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">source</span> <span class="o">/</span> <span class="s2">&quot;train&quot;</span><span class="p">)</span>
<span class="n">train_rs</span><span class="p">,</span> <span class="n">valid_rs</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">data_splitter</span><span class="p">)</span>

<span class="c1"># shows images with corresponding labels and boxes</span>
<span class="n">show_record</span><span class="p">(</span><span class="n">train_rs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Transform: supporting albumentations transforms out of the box</span>
<span class="n">train_tfm</span> <span class="o">=</span> <span class="n">AlbuTransform</span><span class="p">([</span><span class="n">A</span><span class="o">.</span><span class="n">Flip</span><span class="p">()])</span>

<span class="c1"># Create both training and validation datasets</span>
<span class="n">train_ds</span> <span class="o">=</span> <span class="n">Dataset</span><span class="p">(</span><span class="n">train_rs</span><span class="p">,</span> <span class="n">train_tfm</span><span class="p">)</span>
<span class="n">valid_ds</span> <span class="o">=</span> <span class="n">Dataset</span><span class="p">(</span><span class="n">valid_rs</span><span class="p">)</span>

<span class="c1"># Create both training and validation dataloaders</span>
<span class="n">train_dl</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">dataloader</span><span class="p">(</span><span class="n">train_ds</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">num_workers</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">valid_dl</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">dataloader</span><span class="p">(</span><span class="n">valid_ds</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">num_workers</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Use pre-trained backbone</span>
<span class="n">resnet_101_backbone</span> <span class="o">=</span> <span class="n">MantisFasterRCNN</span><span class="o">.</span><span class="n">get_backbone_by_name</span><span class="p">(</span><span class="s2">&quot;resnet101&quot;</span><span class="p">,</span> <span class="n">fpn</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">pretrained</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Create model</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">WheatModel</span><span class="p">(</span><span class="n">n_class</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">backbone</span><span class="o">=</span><span class="n">resnet_101_backbone</span><span class="p">)</span>

<span class="c1"># Train (fit) model</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">max_epochs</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">gpus</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">trainer</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">train_dl</span><span class="p">,</span> <span class="n">valid_dl</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="tutorials">
<h3>Tutorials<a class="headerlink" href="#tutorials" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="https://lgvaz.github.io/mantisshrimp/tutorials/mantisshrimp_models/faster_rcnn_quickstart.html">Quickstart</a> : shows how to create a custom parser (WheatParser), and train the <strong>Wheat dataset</strong></p>
<p><a class="reference external" href="https://lgvaz.github.io/mantisshrimp/tutorials/mantisshrimp_hub/hub_wheat_finetun.html">Wheat-Detr</a> : shows how to use a custom parser (WheatParser), and train the <strong>Wheat dataset</strong> using Detr</p>
<p><a class="reference external" href="https://lgvaz.github.io/mantisshrimp/tutorials/mantisshrimp_hub/hub_detr_finetune_pennfundan.html">Penn-Fundan</a> : shows how to use the predefined COCO parser, and train the <strong>Penn-Fundan dataset</strong> using Detr</p>
<p>Be sure to also check the other tutorials in the <a class="reference external" href="tutorials/">tutorials</a> folder.</p>
</div>
</div>
<div class="section" id="contributing">
<h2>Contributing<a class="headerlink" href="#contributing" title="Permalink to this headline">¶</a></h2>
<p>Check out our <a class="reference external" href="https://lgvaz.github.io/mantisshrimp/contributing.html">contributing guide</a>.</p>
</div>
<div class="section" id="faqs-and-feature-requests">
<h2>FAQs and Feature Requests<a class="headerlink" href="#faqs-and-feature-requests" title="Permalink to this headline">¶</a></h2>
<p>Please check out our <a class="reference external" href="https://lgvaz.github.io/mantisshrimp/faqs.html">FAQs</a> page. For Feature Requests and more questions raise a github <a class="reference external" href="https://github.com/lgvaz/mantisshrimp/issues/">issue</a>.</p>
<p>We will be happy to assist you.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="contributing.html" class="btn btn-neutral float-right" title="Contributing to MantisShrimp" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral float-left" title="Mantisshrimp Documentation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Lucas Goulart Vazquez

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>